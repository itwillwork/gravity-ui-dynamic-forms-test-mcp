{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Gravity UI Dynamic Forms Spec",
  "description": "Schema for @gravity-ui/dynamic-forms configuration",
  "oneOf": [
    { "$ref": "#/definitions/ArraySpec" },
    { "$ref": "#/definitions/BooleanSpec" },
    { "$ref": "#/definitions/NumberSpec" },
    { "$ref": "#/definitions/ObjectSpec" },
    { "$ref": "#/definitions/StringSpec" }
  ],
  "definitions": {
    "BaseViewSpec": {
      "type": "object",
      "properties": {
        "type": {
          "type": "string",
          "description": "Key to define Input/View for an entity"
        },
        "layout": {
          "type": "string",
          "description": "Key to define Layout for an entity"
        },
        "layoutTitle": {
          "type": "string",
          "description": "Title for Layout"
        },
        "layoutDescription": {
          "type": "string",
          "description": "Additional description/hint for Layout"
        },
        "layoutOpen": {
          "type": "boolean",
          "description": "Expand Layout at the first rendering"
        },
        "disabled": {
          "type": "boolean",
          "description": "Is the field available for editing"
        },
        "hidden": {
          "type": "boolean",
          "description": "Hide field and view"
        },
        "link": {
          "description": "A field containing information for forming a link for a value"
        },
        "inputProps": {
          "type": "object",
          "description": "Additional properties for internal input components"
        }
      },
      "required": ["type"]
    },
    "ArraySpec": {
      "type": "object",
      "properties": {
        "type": {
          "type": "string",
          "const": "array"
        },
        "defaultValue": {
          "type": "array",
          "description": "Default value"
        },
        "required": {
          "type": "boolean",
          "description": "Can the value be undefined or null"
        },
        "maxLength": {
          "type": "integer",
          "minimum": 0,
          "description": "Maximum number of array elements"
        },
        "minLength": {
          "type": "integer",
          "minimum": 0,
          "description": "Minimum number of array elements"
        },
        "items": {
          "$ref": "#",
          "description": "Entity spec for an array element"
        },
        "enum": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "An array of valid values, for example for a select"
        },
        "description": {
          "type": "object",
          "additionalProperties": {
            "type": "string"
          },
          "description": "Beautiful names for values from enum"
        },
        "validator": {
          "type": "string",
          "description": "The key for determining the validator for the entity"
        },
        "viewSpec": {
          "allOf": [
            { "$ref": "#/definitions/BaseViewSpec" },
            {
              "type": "object",
              "properties": {
                "itemLabel": {
                  "type": "string",
                  "description": "Text for the button that adds an array element"
                },
                "itemPrefix": {
                  "type": "string",
                  "description": "Additional text for an element in the array"
                },
                "table": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "label": {
                        "type": "string"
                      },
                      "property": {
                        "type": "string"
                      },
                      "description": {
                        "type": "string"
                      },
                      "width": {
                        "type": "number"
                      }
                    },
                    "required": ["label", "property"]
                  },
                  "description": "Array for table column configuration"
                },
                "placeholder": {
                  "type": "string",
                  "description": "A short hint displayed in the field before the user enters the value"
                },
                "addButtonPosition": {
                  "type": "string",
                  "enum": ["down", "right"],
                  "description": "The location of the button adding a new element to the array"
                },
                "selectParams": {
                  "$ref": "#/definitions/SelectParams"
                },
                "checkboxGroupParams": {
                  "$ref": "#/definitions/CheckboxGroupParams"
                }
              }
            }
          ]
        }
      },
      "required": ["type", "viewSpec"]
    },
    "BooleanSpec": {
      "type": "object",
      "properties": {
        "type": {
          "type": "string",
          "const": "boolean"
        },
        "defaultValue": {
          "type": "boolean",
          "description": "Default value"
        },
        "required": {
          "type": "boolean",
          "description": "For true, will show validation error if form field value is false"
        },
        "validator": {
          "type": "string",
          "description": "The key for determining the validator for the entity"
        },
        "viewSpec": {
          "$ref": "#/definitions/BaseViewSpec"
        }
      },
      "required": ["type", "viewSpec"]
    },
    "NumberSpec": {
      "type": "object",
      "properties": {
        "type": {
          "type": "string",
          "const": "number"
        },
        "defaultValue": {
          "type": "number",
          "description": "Default value"
        },
        "required": {
          "type": "boolean",
          "description": "Can the value be undefined or null"
        },
        "maximum": {
          "type": "number",
          "description": "Maximum value"
        },
        "minimum": {
          "type": "number",
          "description": "Minimum value"
        },
        "format": {
          "type": "string",
          "enum": ["float", "int64"],
          "description": "Validation rule"
        },
        "validator": {
          "type": "string",
          "description": "The key for determining the validator for the entity"
        },
        "viewSpec": {
          "allOf": [
            { "$ref": "#/definitions/BaseViewSpec" },
            {
              "type": "object",
              "properties": {
                "placeholder": {
                  "type": "string",
                  "description": "A short hint displayed in the field before the user enters the value"
                },
                "copy": {
                  "type": "boolean",
                  "description": "For true, will add a copy value button"
                }
              }
            }
          ]
        }
      },
      "required": ["type", "viewSpec"]
    },
    "ObjectSpec": {
      "type": "object",
      "properties": {
        "type": {
          "type": "string",
          "const": "object"
        },
        "defaultValue": {
          "type": "object",
          "description": "Default value"
        },
        "required": {
          "type": "boolean",
          "description": "Can the value be undefined or null"
        },
        "properties": {
          "type": "object",
          "additionalProperties": {
            "$ref": "#"
          },
          "description": "Specs of child entities"
        },
        "description": {
          "type": "object",
          "additionalProperties": {
            "type": "string"
          },
          "description": "Easy-to-understand names for keys from properties"
        },
        "validator": {
          "type": "string",
          "description": "The key for determining the validator for the entity"
        },
        "viewSpec": {
          "allOf": [
            { "$ref": "#/definitions/BaseViewSpec" },
            {
              "type": "object",
              "properties": {
                "order": {
                  "type": "array",
                  "items": {
                    "type": "string"
                  },
                  "description": "Array of properties keys in the right order"
                },
                "oneOfParams": {
                  "$ref": "#/definitions/OneOfParams"
                },
                "placeholder": {
                  "type": "string",
                  "description": "A short hint displayed in the field before the user enters the value"
                },
                "delimiter": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "string"
                  },
                  "description": "Values of delimiters of inline object input elements"
                }
              }
            }
          ]
        }
      },
      "required": ["type", "viewSpec"]
    },
    "StringSpec": {
      "type": "object",
      "properties": {
        "type": {
          "type": "string",
          "const": "string"
        },
        "defaultValue": {
          "type": "string",
          "description": "Default value"
        },
        "required": {
          "type": "boolean",
          "description": "Can the value be undefined or null"
        },
        "maxLength": {
          "type": "integer",
          "minimum": 0,
          "description": "Maximum string length"
        },
        "minLength": {
          "type": "integer",
          "minimum": 0,
          "description": "Minimum string length"
        },
        "pattern": {
          "type": "string",
          "description": "RegExp to check the field value"
        },
        "patternError": {
          "type": "string",
          "description": "The text of the validation error by pattern"
        },
        "enum": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "An array of valid values, for example for a select"
        },
        "description": {
          "type": "object",
          "additionalProperties": {
            "type": "string"
          },
          "description": "Easy-to-understand names for values from enum"
        },
        "validator": {
          "type": "string",
          "description": "The key for determining the validator for the entity"
        },
        "viewSpec": {
          "allOf": [
            { "$ref": "#/definitions/BaseViewSpec" },
            {
              "type": "object",
              "properties": {
                "hideValues": {
                  "type": "array",
                  "items": {
                    "type": "string"
                  },
                  "description": "Values that are equated to empty"
                },
                "sizeParams": {
                  "$ref": "#/definitions/SizeParams"
                },
                "monacoParams": {
                  "$ref": "#/definitions/MonacoParams"
                },
                "placeholder": {
                  "type": "string",
                  "description": "A short hint displayed in the field before the user enters the value"
                },
                "fileInput": {
                  "$ref": "#/definitions/FileInput"
                },
                "copy": {
                  "type": "boolean",
                  "description": "For true, will add a copy value button"
                },
                "textContentParams": {
                  "$ref": "#/definitions/TextContentParams"
                },
                "selectParams": {
                  "$ref": "#/definitions/SelectParams"
                },
                "generateRandomValueButton": {
                  "type": "boolean",
                  "description": "Shows a button that allows you to generate a random value"
                },
                "dateInput": {
                  "$ref": "#/definitions/DateInput"
                },
                "radioGroupParams": {
                  "$ref": "#/definitions/RadioGroupParams"
                }
              }
            }
          ]
        }
      },
      "required": ["type", "viewSpec"]
    },
    "SizeParams": {
      "type": "object",
      "properties": {
        "scale": {
          "type": "object",
          "additionalProperties": {
            "type": "object",
            "properties": {
              "factor": {
                "type": "string"
              },
              "title": {
                "type": "string"
              }
            },
            "required": ["factor", "title"]
          },
          "description": "The key of the object is the dimension type"
        },
        "defaultType": {
          "type": "string",
          "description": "The type of dimension in which the form receives and returns a value"
        },
        "viewType": {
          "type": "string",
          "description": "The type of dimension that will be set at the first render"
        }
      },
      "required": ["scale", "defaultType"]
    },
    "MonacoParams": {
      "type": "object",
      "properties": {
        "language": {
          "type": "string",
          "description": "Syntax highlighting language"
        },
        "fontSize": {
          "type": "string",
          "description": "Font size"
        },
        "headerIconSize": {
          "type": "number",
          "description": "Size of the header icon"
        },
        "headerIconIndent": {
          "type": "number",
          "description": "Indent of the header icon"
        },
        "headerTitleVariant": {
          "type": "string",
          "description": "Variant of the header title"
        },
        "headerDialogButtonSize": {
          "type": "string",
          "description": "Size of the dialog button"
        },
        "headerDialogIconSize": {
          "type": "number",
          "description": "Size of the dialog icon"
        }
      },
      "required": ["language"]
    },
    "OneOfParams": {
      "type": "object",
      "properties": {
        "toggler": {
          "type": "string",
          "enum": ["select", "radio", "card", "checkbox", "switch"],
          "description": "Switch type"
        },
        "booleanMap": {
          "type": "object",
          "properties": {
            "true": {
              "type": "string"
            },
            "false": {
              "type": "string"
            }
          },
          "description": "Special object for oneof toggler type checkbox"
        }
      }
    },
    "FileInput": {
      "type": "object",
      "properties": {
        "accept": {
          "type": "string",
          "description": "Acceptable file extensions"
        },
        "readAsMethod": {
          "type": "string",
          "enum": [
            "readAsArrayBuffer",
            "readAsBinaryString",
            "readAsDataURL",
            "readAsText"
          ],
          "description": "File reading method"
        },
        "ignoreText": {
          "type": "boolean",
          "description": "For true, will show the File uploaded stub instead of the field value"
        }
      }
    },
    "DateInput": {
      "type": "object",
      "properties": {
        "outputFormat": {
          "type": "string",
          "description": "Format returning string (for backend and logic)"
        },
        "printFormat": {
          "type": "string",
          "description": "Format print string (for view in read form)"
        },
        "timeZone": {
          "type": "string",
          "description": "Sets the time zone"
        }
      }
    },
    "TextContentParams": {
      "type": "object",
      "properties": {
        "themeLabel": {
          "type": "string",
          "enum": [
            "normal",
            "info",
            "danger",
            "warning",
            "success",
            "unknown"
          ],
          "description": "Label color"
        },
        "text": {
          "type": "string",
          "description": "Text for input"
        },
        "icon": {
          "type": "string",
          "description": "Icon name from the library"
        },
        "iconColor": {
          "type": "string",
          "enum": [
            "primary",
            "complementary",
            "secondary",
            "hint",
            "info",
            "info-heavy",
            "positive",
            "positive-heavy",
            "warning",
            "warning-heavy",
            "danger",
            "danger-heavy",
            "utility",
            "utility-heavy",
            "misc",
            "misc-heavy",
            "brand",
            "dark-primary",
            "dark-complementary",
            "dark-secondary"
          ],
          "description": "The color of the icon"
        },
        "themeIcon": {
          "type": "string",
          "enum": ["normal", "info", "success", "warning", "danger", "utility"],
          "description": "Alert color"
        },
        "titleAlert": {
          "type": "string",
          "description": "Alert title"
        },
        "viewAlert": {
          "type": "string",
          "enum": ["filled", "outlined"],
          "description": "Alert view"
        }
      },
      "required": ["text"]
    },
    "SelectParams": {
      "type": "object",
      "properties": {
        "filterPlaceholder": {
          "type": "string",
          "description": "Placeholder for filter"
        },
        "meta": {
          "type": "object",
          "additionalProperties": {
            "type": "string"
          },
          "description": "Additional text for enum values"
        }
      }
    },
    "CheckboxGroupParams": {
      "type": "object",
      "properties": {
        "placement": {
          "type": "string",
          "enum": ["horizontal", "vertical"],
          "description": "Placement checkbox"
        },
        "disabled": {
          "type": "object",
          "additionalProperties": {
            "type": "boolean"
          },
          "description": "Disabled checkbox for enum values"
        }
      }
    },
    "RadioGroupParams": {
      "type": "object",
      "properties": {
        "direction": {
          "type": "string",
          "enum": ["horizontal", "vertical"],
          "description": "Direction radio group"
        },
        "disabled": {
          "type": "object",
          "additionalProperties": {
            "type": "boolean"
          },
          "description": "Disabled radio group for enum values"
        }
      }
    }
  }
}
